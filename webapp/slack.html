<html ng-app="slackApp">
  <head>
    <meta charset="utf-8">
    <title>Slack Mock Project</title>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.10/angular.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.10/angular-route.min.js"></script>
    
    <script>

    var slackApp = angular.module('slackApp', ['ngRoute']);
      
    slackApp.config(function($routeProvider) {
        $routeProvider.
          when('/', {
            templateUrl: 'home.html',
            controller: 'HomeCtrl'
          }).
   //        when('/:categoryName', {
   //          templateUrl: 'category-detail.html',
   //          controller: 'CategoryDetailCtrl'
   //        }).
   //        when('/cart/:cart', {
			// templateUrl: 'cart.html',
   //          controller: 'CartCtrl'
   //        }).
          otherwise({
            redirectTo: '/'
          });
      });

      //var channels = [];
      slackApp.controller('HomeCtrl', function ($scope, $http){
        //$scope.channels = [];

        $http.get('/channel/user/1').success(function(data) {
          $scope.channels = data;
          $scope.getChannelMessage($scope.channels[0].id);         
        });



          $http.get('/user/user/1').success(function (data){
             //    console.log ("got user name");
                $scope.userName=data[0].userName;
             console.log("name--" + $scope.userName);
          });


     

        $scope.getChannelMessage = function(channel) {
          console.log(channel);
          $http.get('/message/channel/' + channel).success(function(data) {
            $scope.messages = data;
            console.log($scope.messages);
          });


         
        };

         $scope.IsEnter=function(event){
          // console.log (" a keypress");
        
             if (event.keyCode===13){
              // console.log("enter pressed")
              var currentdate = new Date();
             var datetime = currentdate.getDay() + "/"+currentdate.getMonth() 
              + "/" + currentdate.getFullYear() + " " 
              + currentdate.getHours() + ":" 
                + currentdate.getMinutes() + ":" + currentdate.getSeconds();
               console.log ("msg: " ,$scope.msg);//[$scope.message.length-1]);
              //  , "date":Date.now(), "msg":$scope.message)
            
               $scope.messages.push({"userName":$scope.userName, "date":datetime, "msg":$scope.msg});
                 $scope.$apply();

              document.getElementById("txtMsg").value = "";
            
            }
         };

    });


</script>

  </head>

  <body>

    <div ng-include="'header.html'"></div>

    <div ng-view></div>


    <div ng-include="'footer.html'"></div>

  </body>
</html>
